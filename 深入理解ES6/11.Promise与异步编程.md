 # Promise 与 异步编程

JS能极其轻易地处理异步编程，如响应 点击或按键 之类的用户交互行为。

node.js 通过使用回调函数来代替事件，进一步推动了JS中的异步编程。

随着异步编程面对的场景日益复杂，事件与回调 已不足以支持所有需求，
Promise应运而生。

Promise 是异步编程的一种选择，延迟并在将来执行作业。

## 1. 异步编程的背景

### 1.1. 说明

JS引擎建立在单线程事件循环的概念上。

**单线程**

单线程（single-threaded）意味着同一时刻只能执行一段代码。

**多线程**

多段代码可以同时访问或修改状态，维护并保护这些状态就变成了难题。

**作业队列（job queue）**

每当一段代码准备被执行，它就会被添加到作业队列。

**事件循环（event loop）**

事件循环是JS引擎的一个内部处理线程，能监视代码的执行并管理作业队列。

当JS引擎结束当前代码的执行后，事件循环就会执行队列中的下一个作业。

### 1.2. 事件模型

当用户 点击一个按钮 时，一个事件（event）就被触发了，
该事件可能会对此交互进行响应，从而将一个新的作业添加到作业队列的尾部。

事件处理程序代码直到事件发生后才会被执行，此时它会拥有合适的上下文，例如：

    let button = document.getElementById( "btn" );
    button.onclick = function( event ) {
        console.info( "clicked!" );
    }
    