# 第 3 章：理解小程序宿主环境

第 2 章介绍了小程序的文件构成，那么这些文件在微信客户端是怎么协同工作的呢？在本章中我们会介绍微信客户端给小程序所提供的宿主环境，下文我们把这个概念简称为宿主或者宿主环境。

小程序可以调用宿主环境提供的微信客户端的能力，这就使得小程序比普通网页拥有更多的能力。你也会了解到，你的小程序会运行在不同版本的宿主环境下，因此针对各个版本的宿主环境做程序上的兼容也是在所难免的。

## 1. 渲染层和逻辑层

小程序的运行环境分成渲染层和逻辑层，第 2 章提到过 WXML 模板和 WXSS 样式工作在渲染层，JS 脚本工作在逻辑层。小程序的渲染层和逻辑层分离是经过很多考虑得出来的模型，在第 6 章我们会详细阐述这个模型背后的原理以及产生的问题。在本章我们会先介绍这个模型的基本工作方式。

### 1.1. 渲染“Hello World”页面

我们看看小程序是如何把脚本里边的数据渲染在界面上的。

WXML 模板使用 `view` 标签，其子节点用 `{{ }}` 的语法绑定一个 `msg` 的变量，如代码清单 3-1 所示。

代码清单 3-1， 渲染 “`Hello World`” WXML 代码：

```xml
<view>{{ msg }}</view>
```

在 JS 脚本使用 `this.setData` 方法把 `msg` 字段设置成 “`Hello World`” ，如代码清单 3-2 所示。

代码清单 3-2， 渲染 “`Hello World`” JS脚本：

```javascript
Page({
  onLoad: function () {
    this.setData({ msg: 'Hello World' })
  }
})
```

从这个例子我们可以看到 3 个点：

* 渲染层和数据相关。
* 逻辑层负责产生、处理数据。
* 逻辑层通过 `Page` 实例的 `setData` 方法传递数据到渲染层。

关于第 1 点，涉及了“数据驱动”的概念，我们会在 3.1.3 节详细讨论，我们现在先看看第 3 点涉及的“通信模型”。
