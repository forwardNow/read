# 1.1 生成 HTTP 请求消息

## 1.1.1 探索之旅从输入网址开始

* 网址,准确来说应该叫 URL（以 http:// 开头的那一串东西）
* 除了“http:”,网址还可以以其他一些字符开头,
  例如“ftp:”“file:” “mailto:” 等
* 如果没有正确配置电子邮件软件,
  则即使在地址栏中输入“mailto:”也是无法正常工作的。
  
**为什么有各种各样的URL呢？**
  
  * 尽管我们通常是使用浏览器来访问 Web 服务器的，
    但实际上浏览器并不只有这一个功能
  * 它也可以用来在 FTP 服务器上下载和上传文件，
    同时也具备电子邮件客户端的功能。
  * 可以说,浏览器是一个具备多种客户端功能的综合性 客户端软件  
  * 因此它需要一些东西来判断应该使用其中哪种功能来访问相应的数据，
    而各种不同的 URL 就是用来干这个的，
    比如访问 Web 服务器时用“http:”， 而访问 FTP 服务器时用“ftp:”。
    
**互联网中常见的几种 URL**

 * 根据访问目标的不同, URL 的写法也会不同
 * 用HTTP协议访问Web服务器时
    * http://user:password@www.glasscom.com:80/dir/file1.htm 
 * 用FTP协议下载和上传文件时
    * ftp://user:password@ftp.glasscom.com:21/dir/file1.htm
 * 读取客户端计算机本地文件时
    * file://localhost/c:/path/file1.zip
 * 发送电子邮件时
    * mailto:tone@glasscom.com
 * 阅读新闻组的文章时
    * news:comp.protocols.tcp-ip
    
**URL 开头的文字，表示浏览器应当使用的访问方法**

 * “http:” “ftp:” “file:” “mailto:”
 * 当访问 Web 服务器时应该使用 HTTPA 协议，
   访问 FTP 服务器时则应该使用 FTP 协议 
 * 我们可以把这部分理解为访问时使用的协议类型 
 
## 1.1.2 浏览器先要解析 URL

 * 浏览器要做的第一步工作就是对 URL 进行解析,
   从而生成发送给 Web 服务器的请求消息。
 * 当对 URL 进行解析时,首先需要将其中的各个元素拆分出来  
 * 如：http://www.lab.glasscom.com/dir1/file1.html
   =>
   http: + // + www.lab.glasscom.com + / + dir1 + / + file1.html
   
## 1.1.3 省略文件名的情况

### (a) http://www.lab.glasscom.com/dir/
 * URL 是以“/”来结尾
 * 可以理解为, 以“/”结尾代表 /dir/ 后面本来应该有的文件名被省略了
 * 没有文件名,服务器怎么知道要访问哪个文件呢？
 * 我们会在服务器上事先设置好文件名省略时要访问的默认文件名  
 * 这个设置根 据服务器不同而不同,
   大多数情况下是 index.html 或者 default.htm 之类的文件名 

### (b) http://www.lab.glasscom.com/
 * 以“/”结尾的，只有 Web 服务器的域名的
 * 也就是说它表示访问一个名叫“/”的目录
 * 由于省略了文件名,
   所以结果就是访问 /index.html 或者 /default.htm 这样的文件了
 * “/”目录表示目录层级中最顶层的“根目录”。
   
### (c) http://www.lab.glasscom.com
 * 连结尾的“/”都省略了
 * 当没有路径名时,就代表访问根目录下事先设置的默认文件,
   也就是 /index. html 或者 /default.htm 这些文件
   
### (d) http://www.lab.glasscom.com/whatisthis
 * 如果 Web 服务器上存在名为 whatisthis 的文件,
   则将 whatisthis 作为文件名来处理
 * 如果存在名为 whatisthis 的目录,
   则将 whatisthis 作为目录名来处理
   
## 1.1.4 HTTP 的基本思路 

 * 解析完 URL 之后,我们就知道应该要访问的目标在哪里了。
   接下来, 浏览器会使用 HTTP 协议来访问 Web 服务器
 * HTTP 协议定义了客户端和服务器之间如何进行交互（消息内容和步骤）。
 
### 请求消息

 * 客户端会向服务器发送请求消息，
   请求中包含两部分：“对什么” “进行怎样的操作”  
 * “对什么”的部分称为 URI，
   URI 的内容是一个存放网页数据的文件名 或者是 一个 CGI 程序的文件名。
 * CGI 程序:对 Web 服务器程序调用其他程序的规则所做的定义就是 CGI,
   而按照 CGI 规范来工作的程序就称为 CGI 程序。
 * 实际上,这个文件在 Web 服务器上未必是真实存在的,
   因为 Web 服务器可以通过重写规则对虚拟的 URI 进行映射。
 * “进行怎样的操作”的部分称为方法,也叫 HTTP 谓词,或者 HTTP 动词。
   表示需要让 Web 服务器完成怎样的工作
 * HTTP 的主要方法 
    * GET: 
        获取 URI 指定的信息。
        如果 URI 指定的是文件,则 返回文件的内容;
        如果 URI 指定的是 CGI 程序,则 返回该程序的输出数据
    * POST:
        从客户端向服务器发送数据。
        一般用于发送表单中 填写的数据等情况下
 * HTTP 消息中还有一些用来表示附加信息的 头字段。
   客户端向 Web 服务器发送数据时,会先发送头字段,然后再发送数据。
   不过,头字段属于可有可无的附加信息   
   
### 响应消息

 * 收到请求消息之后,Web 服务器会对其中的内容进行解析,
   通过 URI 和方法来判断“对什么”“进行怎样的操作”,
   并根据这些要求来完成自己的工作,
   然后将结果存放在响应消息中.
 * 在响应消息的开头有一个状态码, 
   它用来表示操作的执行结果是成功还是发生了错误。
 * 当我们访问 Web 服务器时,
   遇到找不到的文件就会显示出404 Not Found的错误信息,其实这就是状态码。
 * 状态码后面就是头字段和网页数据。
 * 响应消息会被发送回客户端,客户端收到之后,
   浏览器会从消息中读出所需的数据并显示在屏幕上。
   
### 关于 HTTP 方法的知识
 
 * 最常用的一个就是 GET 方法了,
   一般当我们访问 Web 服务器获取网页数据时,使用的就是 GET 方法。
   所谓一般的访问过程大概就是这样的:
    * 首先,在请求消息中写上 GET 方法, 
      然后在 URI 中写上存放网页数据的文件名“/dir1/file1.html”,
      这就表示我 们需要获取 /dir1/file1.html 文件中的数据。
    * 当 Web 服务器收到消息后,
      会打开 /dir1/file1.html 文件并读取出里面的数据,
      然后将读出的数据存放到响应消息中,并返回给客户端。
    * 最后,客户端浏览器会收到这些数据并显示在屏幕上。
 * 还有一个经常使用的方法就是 POST。
   我们在表单中填写数据并将其 发送给 Web 服务器时就会使用这个方法。
   当我们在网上商城填写收货地址和姓􏰀名,或者是在网上填写问卷时,
   都会遇到带有输入框的网页,而这些可以输入信息的部分就是表单。
   * 使用 POST 方法时,
     URI 会指向 Web 服务器中运行的一个应用程序的文件名,
     典型的例子包括“index.cgi”“index. php”等
   * 然后,在请求消息中,除了方法和 URI 之外,
     还要加上传递给应用程序和脚本的数据。
     这里的数据也就是用户在输入框里填写的信息。
   * 当服务器收到消息后,
     Web 服务器会将请求消息中的数据发送给 URI 指定的应用程序。
   * 最后,Web 服务器从应用程序接收输出的结果,
     会将它存放到响应消息中并返回给客户端。
     
 1.1.5 生成 HTTP 请求消息
    