# 2.6 UDP 协议的收发操作

## 2.6.1 不需要重发的数据用 UDP 发送更高效

跟着第 1 章的脚步,本章我们探索了通过套接字收发数据的整个过程, 这个过程到这里已经告一段落了。
接下来,网络包会从计算机出来跑向集 线器,这个过程我们将在下一章来介绍,现在先来说点题外话。

大多数的应用程序都像之前介绍的一样使用 TCP 协议来收发数据,但当然也有例外。
有些应用程序不使用 TCP 协议,而是使用 UDP 协议来收发数据。
向 DNS 服务器查询 IP 地址的时候我们用的也是 UDP 协议。
下面就简单介绍一下 UDP 协议。

其实 TCP 中就包含了 UDP 的一些要点。
TCP 的工作方式十分复杂, 如果我们能够理解 TCP 为什么要设计得如此复杂,也就能够理解 UDP 了。 
那么,为什么要设计得如此复杂呢?因为我们需要将数据高效且可靠地发送给对方。
为了实现可靠性,我们就需要确认对方是否收到了我们发送的数据,如果没有还需要再发一遍。

要实现上面的要求,最简单的方法是数据全部发送完毕之后让接收方返回一个接收确认。
这样一来,如果没收到直接全部重新发送一遍就好了, 根本不用像 TCP 一样要管理发送和确认的进度。
但是,如果漏掉了一个包就要全部重发一遍,怎么看都很低效。
为了实现高效的传输,我们要避免重发已经送达的包,而是只重发那些出错的或者未送达的包。
TCP 之所以复杂,就是因为要实现这一点。

不过,在某种情况下,即便没有 TCP 这样复杂的机制,我们也能够高效地重发数据,
这种情况就是数据很短,用一个包就能装得下。
如果只有一个包,就不用考虑哪个包未送达了,因为全部重发也只不过是重发一个包而已,
这种情况下我们就不需要 TCP 这样复杂的机制了。
而且,如果不使用 TCP,也不需要发送那些用来建立和断开连接的控制包了。
此外,我们发送了数据,对方一般都会给出回复,只要将回复的数据当作接收确认就行了,也不需要专门的接收确认包了。

## 2.6.2 控制用的短数据